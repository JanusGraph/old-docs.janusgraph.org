<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;4.&nbsp;Configuration</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="JanusGraph Documentation"><link rel="up" href="basics.html" title="Part&nbsp;II.&nbsp;JanusGraph Basics"><link rel="prev" href="basics.html" title="Part&nbsp;II.&nbsp;JanusGraph Basics"><link rel="next" href="schema.html" title="Chapter&nbsp;5.&nbsp;Schema and Data Modeling"><script xmlns:d="https://docbook.org/ns/docbook" type="text/javascript" src="js/jquery/jquery-1.11.0.js"></script><script xmlns:d="https://docbook.org/ns/docbook" type="text/javascript" src="js/jquery/jquery-migrate-1.2.1.min.js"></script><link xmlns:d="https://docbook.org/ns/docbook" rel="stylesheet" id="inline-blob-janusgraph-docs-specific" href="css/docs.css" type="text/css" media="all"><link xmlns:d="https://docbook.org/ns/docbook" rel="apple-touch-icon" type="image/png" href="images/janusgraph-logomark.png"><script xmlns:d="https://docbook.org/ns/docbook" type="text/javascript">
      WebFontConfig = {
        google: {
          families: [
            "Lato:400,400italic,700,700italic:latin,greek-ext,cyrillic,latin-ext,greek,cyrillic-ext,vietnamese",
            "Open+Sans:400,400italic,700,700italic:latin,greek-ext,cyrillic,latin-ext,greek,cyrillic-ext,vietnamese",
            "Antic+Slab:400,400italic,700,700italic:latin,greek-ext,cyrillic,latin-ext,greek,cyrillic-ext,vietnamese"
          ]
        }
      };
      (function() {
      var wf = document.createElement('script');
      wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
        '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
	wf.type = 'text/javascript';
	wf.async = 'true';
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(wf, s);
	})();
    </script></head><body xmlns:d="https://docbook.org/ns/docbook" bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div id="wrapper"><div class="header-wrapper"><header id="header"><ul class="header-list"><li class="header-item"><a href="https://janusgraph.org"><img src="images/janusgraph-logo.png" alt="JanusGraph" class="normal_logo"></a></li><li class="header-item-right"><a href="https://github.com/JanusGraph/janusgraph/releases">Download JanusGraph</a></li><li class="header-item-right dropdown"><a href="https://docs.janusgraph.org/latest/doc-versions.html">Other Doc Versions</a><div class="dropdown-content"><a href="https://docs.janusgraph.org/latest/index.html">Latest</a><a href="https://docs.janusgraph.org/0.3.2/index.html">Version 0.3.2</a><a href="https://docs.janusgraph.org/0.3.1/index.html">Version 0.3.1</a><a href="https://docs.janusgraph.org/0.3.0/index.html">Version 0.3.0</a><a href="https://docs.janusgraph.org/0.2.3/index.html">Version 0.2.3</a><a href="https://docs.janusgraph.org/0.2.2/index.html">Version 0.2.2</a><a href="https://docs.janusgraph.org/0.2.1/index.html">Version 0.2.1</a><a href="https://docs.janusgraph.org/0.2.0/index.html">Version 0.2.0</a><a href="https://docs.janusgraph.org/0.1.1/index.html">Version 0.1.1</a><a href="https://docs.janusgraph.org/0.1.0/index.html">Version 0.1.0</a></div></li><li class="header-item-right"><a href="index.html">Documentation (0.3.2)</a></li></ul></header></div><div id="main" class="clearfix width-100"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">JanusGraph Documentation</a></span> &gt; <span class="breadcrumb-link"><a href="basics.html">JanusGraph Basics</a></span> &gt; <span class="breadcrumb-node">Configuration</span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="configuration"></a>Chapter&nbsp;4.&nbsp;Configuration</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="configuration.html#_example_configurations">4.1. Example Configurations</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#_cassandra_elasticsearch">4.1.1. Cassandra+Elasticsearch</a></span></dt><dt><span class="section"><a href="configuration.html#_hbase_caching">4.1.2. HBase+Caching</a></span></dt><dt><span class="section"><a href="configuration.html#_berkeleydb">4.1.3. BerkeleyDB</a></span></dt><dt><span class="section"><a href="configuration.html#_further_examples">4.1.4. Further Examples</a></span></dt></dl></dd><dt><span class="section"><a href="configuration.html#_using_configuration">4.2. Using Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#_janusgraphfactory">4.2.1. JanusGraphFactory</a></span></dt><dt><span class="section"><a href="configuration.html#_janusgraph_server">4.2.2. JanusGraph Server</a></span></dt></dl></dd><dt><span class="section"><a href="configuration.html#configuration-global">4.3. Global Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="configuration.html#_changing_offline_options">4.3.1. Changing Offline Options</a></span></dt></dl></dd></dl></div>

<p>A JanusGraph graph database cluster consists of one or multiple JanusGraph instances. To open a JanusGraph instance, a configuration has to be provided which specifies how JanusGraph should be set up.</p>
<p>A JanusGraph configuration specifies which components JanusGraph should use, controls all operational aspects of a JanusGraph deployment, and provides a number of tuning options to get maximum performance from a JanusGraph cluster.</p>
<p>At a minimum, a JanusGraph configuration must define the persistence engine that JanusGraph should use as a storage backend. <a class="xref" href="storage-backends.html" title="Part&nbsp;IV.&nbsp;Storage Backends">Part&nbsp;IV, &#8220;Storage Backends&#8221;</a> lists all supported persistence engines and how to configure them respectively.
If advanced graph query support (e.g full-text search, geo search, or range queries) is required an additional indexing backend must be configured.  See <a class="xref" href="index-backends.html" title="Part&nbsp;V.&nbsp;Index Backends">Part&nbsp;V, &#8220;Index Backends&#8221;</a> for details. If query performance is a concern, then caching should be enabled.  Cache configuration and tuning is described in <a class="xref" href="caching.html" title="Chapter&nbsp;13.&nbsp;JanusGraph Cache">Chapter&nbsp;13, <i>JanusGraph Cache</i></a>.</p>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_example_configurations"></a>4.1.&nbsp;Example Configurations</h2></div></div></div>

<p>Below are some example configuration files to demonstrate how to configure the most commonly used storage backends, indexing systems, and performance components. This covers only a tiny portion of the available configuration options. Refer to <a class="xref" href="config-ref.html" title="Chapter&nbsp;15.&nbsp;Configuration Reference">Chapter&nbsp;15, <i>Configuration Reference</i></a> for the complete list of all options.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_cassandra_elasticsearch"></a>4.1.1.&nbsp;Cassandra+Elasticsearch</h3></div></div></div>

<p>Sets up JanusGraph to use the Cassandra persistence engine running locally and a remote Elastic search indexing system:</p>
<pre class="programlisting"><span class="hl-attribute">storage.backend</span>=cql
<span class="hl-attribute">storage.hostname</span>=localhost

<span class="hl-attribute">index.search.backend</span>=elasticsearch
<span class="hl-attribute">index.search.hostname</span>=100.100.101.1, 100.100.101.2
<span class="hl-attribute">index.search.elasticsearch.client-only</span>=true</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_hbase_caching"></a>4.1.2.&nbsp;HBase+Caching</h3></div></div></div>

<p>Sets up JanusGraph to use the HBase persistence engine running remotely and uses JanusGraph&#8217;s caching component for better performance.</p>
<pre class="programlisting"><span class="hl-attribute">storage.backend</span>=hbase
<span class="hl-attribute">storage.hostname</span>=100.100.101.1
<span class="hl-attribute">storage.port</span>=2181

<span class="hl-attribute">cache.db-cache </span>= true
<span class="hl-attribute">cache.db-cache-clean-wait </span>= 20
<span class="hl-attribute">cache.db-cache-time </span>= 180000
<span class="hl-attribute">cache.db-cache-size </span>= 0.5</pre>

</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_berkeleydb"></a>4.1.3.&nbsp;BerkeleyDB</h3></div></div></div>

<p>Sets up JanusGraph to use BerkeleyDB as an embedded persistence engine with Elasticsearch as an embedded indexing system.</p>
<pre class="programlisting"><span class="hl-attribute">storage.backend</span>=berkeleyje
<span class="hl-attribute">storage.directory</span>=/tmp/graph

<span class="hl-attribute">index.search.backend</span>=elasticsearch
<span class="hl-attribute">index.search.directory</span>=/tmp/searchindex
<span class="hl-attribute">index.search.elasticsearch.client-only</span>=false
<span class="hl-attribute">index.search.elasticsearch.local-mode</span>=true</pre>

<p><a class="xref" href="config-ref.html" title="Chapter&nbsp;15.&nbsp;Configuration Reference">Chapter&nbsp;15, <i>Configuration Reference</i></a> describes all of these configuration options in detail. The <code class="literal">conf</code> directory of the JanusGraph distribution contains additional configuration examples.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_further_examples"></a>4.1.4.&nbsp;Further Examples</h3></div></div></div>

<p>There are several example configuration files in the <code class="literal">conf/</code> directory that can be used to get started with JanusGraph quickly.  Paths to these files can be passed to <code class="literal">JanusGraphFactory.open(...)</code> as shown below:</p>
<pre class="programlisting"><em class="hl-comment">// Connect to Cassandra on localhost using a default configuration</em>
graph = JanusGraphFactory.open(<span class="hl-string">"conf/janusgraph-cql.properties"</span>)
<em class="hl-comment">// Connect to HBase on localhost using a default configuration</em>
graph = JanusGraphFactory.open(<span class="hl-string">"conf/janusgraph-hbase.properties"</span>)</pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_using_configuration"></a>4.2.&nbsp;Using Configuration</h2></div></div></div>

<p>How the configuration is provided to JanusGraph depends on the instantiation mode.</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_janusgraphfactory"></a>4.2.1.&nbsp;JanusGraphFactory</h3></div></div></div>

<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_gremlin_console"></a>4.2.1.1.&nbsp;Gremlin Console</h4></div></div></div>

<p>The JanusGraph distribution contains a command line Gremlin Console which makes it easy to get started and interact with JanusGraph. Invoke <code class="literal">bin/gremlin.sh</code> (Unix/Linux) or <code class="literal">bin/gremlin.bat</code>
(Windows) to start the Console and then open a JanusGraph graph using the factory with the configuration stored in an accessible properties configuration file:</p>
<pre class="programlisting">graph<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>JanusGraphFactory.open<span class="hl-gremlin-func">(</span><span class="hl-string">'path/to/configuration.properties'</span><span class="hl-gremlin-func">)</span></pre>

</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_janusgraph_embedded"></a>4.2.1.2.&nbsp;JanusGraph Embedded</h4></div></div></div>

<p>JanusGraphFactory can also be used to open an embedded JanusGraph graph instance from within a JVM-based user application. In that case, JanusGraph is part of the user application and the application can call upon JanusGraph directly through its public API.</p>
</div>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_short_codes"></a>4.2.1.3.&nbsp;Short Codes</h4></div></div></div>

<p>If the JanusGraph graph cluster has been previously configured and/or only the storage backend needs to be defined, JanusGraphFactory accepts a colon-separated string representation of the storage backend name and hostname or directory.</p>
<pre class="programlisting">graph<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>JanusGraphFactory.open<span class="hl-gremlin-func">(</span><span class="hl-string">'cql:localhost'</span><span class="hl-gremlin-func">)</span></pre>

<pre class="programlisting">graph<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>JanusGraphFactory.open<span class="hl-gremlin-func">(</span><span class="hl-string">'berkeleyje:/tmp/graph'</span><span class="hl-gremlin-func">)</span></pre>

</div>
</div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_janusgraph_server"></a>4.2.2.&nbsp;JanusGraph Server</h3></div></div></div>

<p>JanusGraph, by itself, is simply a set of jar files with no thread of execution.  There are two basic patterns for connecting to, and using a JanusGraph database:</p>
<div class="orderedlist"><p class="title"><b>Patterns</b></p><ol class="orderedlist" type="1"><li class="listitem">
JanusGraph can be used by embedding JanusGraph calls in a client program where the program provides the thread of execution.
</li><li class="listitem">
JanusGraph packages a long running server process that, when started, allows a remote client or logic running in a separate program to make JanusGraph calls.  This long running server process is called <span class="strong"><strong>JanusGraph Server</strong></span>.
</li></ol></div>

<p>For the JanusGraph Server, JanusGraph uses <a class="link" href="https://tinkerpop.apache.org/docs/3.3.3/reference#gremlin-server" target="_top">Gremlin Server</a> of the <a class="link" href="https://tinkerpop.apache.org/" target="_top">Apache TinkerPop</a> stack to service client requests.  JanusGraph provides an out-of-the-box configuration for a quick start with JanusGraph Server, but the configuration can be changed to provide a wide range of server capabilities.</p>
<p>Configuring JanusGraph Server is accomplished through a JanusGraph Server yaml configuration file located in the ./conf/gremlin-server directory in the JanusGraph distribution. To configure JanusGraph Server with a graph instance (<code class="literal">JanusGraph</code>), the JanusGraph Server configuration file requires the following settings:</p>
<pre class="programlisting">...
graphs: {
  graph: conf/janusgraph-berkeleyje.properties
}
scriptEngines: {
  gremlin-groovy: {
    plugins: { org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin: {},
               org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {},
               org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin: {},
               org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]},
               org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [scripts/empty-sample.groovy]}}}}
...</pre>

<p>The entry for <code class="literal">graphs</code> defines the bindings to specific <code class="literal">JanusGraph</code> configurations. In the above case it binds <code class="literal">graph</code> to a JanusGraph configuration at <code class="literal">conf/janusgraph-berkeleyje.properties</code>.  The <code class="literal">plugins</code> entry enables the JanusGraph Gremlin Plugin, which enables auto-imports of JanusGraph classes so that they can be referenced in remotely submitted scripts.</p>
<p>Learn more about configuring and using JanusGraph Server in <a class="xref" href="server.html" title="Chapter&nbsp;7.&nbsp;JanusGraph Server">Chapter&nbsp;7, <i>JanusGraph Server</i></a>.</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_server_distribution"></a>4.2.2.1.&nbsp;Server Distribution</h4></div></div></div>

<p>The JanusGraph zip file contains a quick start server component that helps make it easier to get started with Gremlin Server and JanusGraph. Invoke <code class="literal">bin/janusgraph.sh start</code> to start Gremlin Server with Cassandra and Elasticsearch.</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/icons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
<p>For security reasons Elasticsearch and therefore <code class="literal">janusgraph.sh</code> must be run under a non-root account</p>
</td></tr></table></div>

</div>
</div>
</div>
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-global"></a>4.3.&nbsp;Global Configuration</h2></div></div></div>

<p>JanusGraph distinguishes between local and global configuration options. Local configuration options apply to an individual JanusGraph instance. Global configuration options apply to all instances in a cluster. More specifically, JanusGraph distinguishes the following five scopes for configuration options:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="strong"><strong>LOCAL</strong></span>: These options only apply to an individual JanusGraph instance and are specified in the configuration provided when initializing the JanusGraph instance.
</li><li class="listitem">
<span class="strong"><strong>MASKABLE</strong></span>: These configuration options can be overwritten for an individual JanusGraph instance by the local configuration file. If the local configuration file does not specify the option, its value is read from the global JanusGraph cluster configuration.
</li><li class="listitem">
<span class="strong"><strong>GLOBAL</strong></span>: These options are always read from the cluster configuration and cannot be overwritten on an instance basis.
</li><li class="listitem">
<span class="strong"><strong>GLOBAL_OFFLINE</strong></span>: Like <span class="emphasis"><em>GLOBAL</em></span>, but changing these options requires a cluster restart to ensure that the value is the same across the entire cluster.
</li><li class="listitem">
<span class="strong"><strong>FIXED</strong></span>: Like <span class="emphasis"><em>GLOBAL</em></span>, but the value cannot be changed once the JanusGraph cluster is initialized.
</li></ul></div>

<p>When the first JanusGraph instance in a cluster is started, the global configuration options are initialized from the provided local configuration file. Subsequently changing global configuration options is done through JanusGraph&#8217;s management API. To access the management API, call <code class="literal">g.getManagementSystem()</code> on an open JanusGraph instance handle <code class="literal">g</code>. For example, to change the default caching behavior on a JanusGraph cluster:</p>
<pre class="programlisting">mgmt<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>graph.openManagement<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.get<span class="hl-gremlin-func">(</span><span class="hl-string">'cache.db-cache'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span><em class="hl-comment">// Prints the current config setting</em><span class="hl-gremlin-func">
</span>mgmt.set<span class="hl-gremlin-func">(</span><span class="hl-string">'cache.db-cache'</span>,<span class="hl-gremlin-func"> </span>true<span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span><em class="hl-comment">// Changes option</em><span class="hl-gremlin-func">
</span>mgmt.get<span class="hl-gremlin-func">(</span><span class="hl-string">'cache.db-cache'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span><em class="hl-comment">// Prints 'true'</em><span class="hl-gremlin-func">
</span>mgmt.commit<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span><em class="hl-comment">// Changes take effect</em></pre>

<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_changing_offline_options"></a>4.3.1.&nbsp;Changing Offline Options</h3></div></div></div>

<p>Changing configuration options does not affect running instances and only applies to newly started ones. Changing <span class="emphasis"><em>GLOBAL_OFFLINE</em></span> configuration options requires restarting the cluster so that the changes take effect immediately for all instances.
To change <span class="emphasis"><em>GLOBAL_OFFLINE</em></span> options follow these steps:</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Close all but one JanusGraph instance in the cluster
</li><li class="listitem">
Connect to the single instance
</li><li class="listitem">
Ensure all running transactions are closed
</li><li class="listitem">
Ensure no new transactions are started (i.e. the cluster must be offline)
</li><li class="listitem">
Open the management API
</li><li class="listitem">
Change the configuration option(s)
</li><li class="listitem">
Call commit which will automatically shut down the graph instance
</li><li class="listitem">
Restart all instances
</li></ul></div>

<p>Refer to the full list of configuration options in <a class="xref" href="config-ref.html" title="Chapter&nbsp;15.&nbsp;Configuration Reference">Chapter&nbsp;15, <i>Configuration Reference</i></a> for more information including the configuration scope of each option.</p>
</div>
</div>
</div></div><div class="clearer"></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="basics.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="basics.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="schema.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;II.&nbsp;JanusGraph Basics&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;5.&nbsp;Schema and Data Modeling</td></tr></table></div><div class="footer-wrapper"><footer id="footer"><div class="copyright">
              Copyright &copy; 2017 JanusGraph Authors. All rights reserved.<br>
              The Linux Foundation has registered trademarks and uses trademarks. For a list of<br>
              trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a> page.<br>
              Cassandra, Groovy, HBase, Hadoop, Lucene, Solr, and TinkerPop are trademarks of the Apache Software Foundation.<br>
              Berkeley DB and Berkeley DB Java Edition are trademarks of Oracle.<br>
              Documentation generated with <a href="https://www.methods.co.nz/asciidoc/">AsciiDoc</a>, <a href="https://asciidoctor.org/">AsciiDoctor</a>, <a href="http://docbook.sourceforge.net/">DocBook</a>, and <a href="http://saxon.sourceforge.net/">Saxon</a>.
        	  </div></footer></div></div></body></html>