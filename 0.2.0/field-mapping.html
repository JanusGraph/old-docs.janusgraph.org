<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;23.&nbsp;Field Mapping</title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="JanusGraph Documentation"><link rel="up" href="index-backends.html" title="Part&nbsp;IV.&nbsp;Index Backends"><link rel="prev" href="index-parameters.html" title="Chapter&nbsp;22.&nbsp;Index Parameters and Full-Text Search"><link rel="next" href="direct-index-query.html" title="Chapter&nbsp;24.&nbsp;Direct Index Query"><script xmlns:d="http://docbook.org/ns/docbook" type="text/javascript" src="js/jquery/jquery-1.11.0.js"></script><script xmlns:d="http://docbook.org/ns/docbook" type="text/javascript" src="js/jquery/jquery-migrate-1.2.1.min.js"></script><link xmlns:d="http://docbook.org/ns/docbook" rel="stylesheet" id="inline-blob-janusgraph-docs-specific" href="css/docs.css" type="text/css" media="all"><link xmlns:d="http://docbook.org/ns/docbook" rel="apple-touch-icon" type="image/png" href="images/janusgraph-logomark.png"><script xmlns:d="http://docbook.org/ns/docbook" type="text/javascript">
      WebFontConfig = {
        google: {
          families: [
            "Lato:400,400italic,700,700italic:latin,greek-ext,cyrillic,latin-ext,greek,cyrillic-ext,vietnamese",
            "Open+Sans:400,400italic,700,700italic:latin,greek-ext,cyrillic,latin-ext,greek,cyrillic-ext,vietnamese",
            "Antic+Slab:400,400italic,700,700italic:latin,greek-ext,cyrillic,latin-ext,greek,cyrillic-ext,vietnamese"
          ]
        }
      };
      (function() {
      var wf = document.createElement('script');
      wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
        '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
	wf.type = 'text/javascript';
	wf.async = 'true';
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(wf, s);
	})();
    </script></head><body xmlns:d="http://docbook.org/ns/docbook" bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div id="wrapper"><div class="header-wrapper"><header id="header"><ul class="header-list"><li class="header-item"><a href="http://janusgraph.org"><img src="images/janusgraph-logo.png" alt="JanusGraph" class="normal_logo"></a></li><li class="header-item-right"><a href="https://github.com/JanusGraph/janusgraph/releases">Download JanusGraph</a></li><li class="header-item-right"><a href="https://github.com/JanusGraph/janusgraph/releases">Other Versions</a></li><li class="header-item-right"><a href="index.html">Documentation (0.2.0)</a></li></ul></header></div><div id="main" class="clearfix width-100"><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">JanusGraph Documentation</a></span> &gt; <span class="breadcrumb-link"><a href="index-backends.html">Index Backends</a></span> &gt; <span class="breadcrumb-node">Field Mapping</span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="field-mapping"></a>Chapter&nbsp;23.&nbsp;Field Mapping</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="field-mapping.html#index-local-field-mapping">23.1. Individual Field Mapping</a></span></dt><dt><span class="section"><a href="field-mapping.html#index-global-field-mapping">23.2. Global Field Mapping</a></span></dt><dd><dl><dt><span class="section"><a href="field-mapping.html#_custom_analyser">23.2.1. Custom Analyser</a></span></dt></dl></dd></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="index-local-field-mapping"></a>23.1.&nbsp;Individual Field Mapping</h2></div></div></div><p>By default, JanusGraph will encode property keys to generate a unique field name for the property key in the mixed index. If one wants to query the mixed index directly in the external index backend can be difficult to deal with and are illegible. For this use case, the field name can be explicitly specified through a parameter.</p><pre class="programlisting">mgmt<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>graph.openManagement<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>name<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>mgmt.makePropertyKey<span class="hl-gremlin-func">(</span><span class="hl-string">'bookname'</span><span class="hl-gremlin-func">)</span>.dataType<span class="hl-gremlin-func">(</span>String.class<span class="hl-gremlin-func">)</span>.make<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.buildIndex<span class="hl-gremlin-func">(</span><span class="hl-string">'booksBySummary'</span>,<span class="hl-gremlin-func"> </span>Vertex.class<span class="hl-gremlin-func">)</span>.addKey<span class="hl-gremlin-func">(</span>name,<span class="hl-gremlin-func"> </span>Parameter.of<span class="hl-gremlin-func">(</span><span class="hl-string">'mapped-name'</span>,<span class="hl-gremlin-func"> </span><span class="hl-string">'bookname'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">)</span>.buildMixedIndex<span class="hl-gremlin-func">(</span><span class="hl-string">"search"</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.commit<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span></pre><p>With this field mapping defined as a parameter, JanusGraph will use the same name for the field in the <code class="literal">booksBySummary</code> index created in the external index system as for the property key. Note, that it must be ensured that the given field name is unique in the index.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="index-global-field-mapping"></a>23.2.&nbsp;Global Field Mapping</h2></div></div></div><p>Instead of individually adjusting the field mapping for every key added to a mixed index, one can instruct JanusGraph to always set the field name in the external index to be identical to the property key name. This is accomplished by enabling the configuration option <code class="literal">map-name</code> which is configured per indexing backend. If this option is enabled for a particular indexing backend, then all mixed indexes defined against said backend will use field names identical to the property key names.</p><p>However, this approach has two limitations: 1) The user has to ensure that the property key names are valid field names for the indexing backend and 2) renaming the property key will NOT rename the field name in the index which can lead to naming collisions that the user has to be aware of and avoid.</p><p>Note, that individual field mappings as described above can be used to overwrite the default name for a particular key.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_custom_analyser"></a>23.2.1.&nbsp;Custom Analyser</h3></div></div></div><p>By default, JanusGraph will use the default analyzer from the indexing backend for properties with Mapping.TEXT, and no analyzer for properties with Mapping.STRING. If one wants to use another analyzer, it can be explicitly specified through a parameter : ParameterType.TEXT_ANALYZER for Mapping.TEXT and ParameterType.STRING_ANALYZER for Mapping.STRING.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_for_elasticsearch"></a>23.2.1.1.&nbsp;For Elasticsearch</h4></div></div></div><p>The name of the analyzer must be set as parameter value.</p><pre class="programlisting">mgmt<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>graph.openManagement<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>string<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>mgmt.makePropertyKey<span class="hl-gremlin-func">(</span><span class="hl-string">'string'</span><span class="hl-gremlin-func">)</span>.dataType<span class="hl-gremlin-func">(</span>String.class<span class="hl-gremlin-func">)</span>.make<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>text<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>mgmt.makePropertyKey<span class="hl-gremlin-func">(</span><span class="hl-string">'text'</span><span class="hl-gremlin-func">)</span>.dataType<span class="hl-gremlin-func">(</span>String.class<span class="hl-gremlin-func">)</span>.make<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>textString<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>mgmt.makePropertyKey<span class="hl-gremlin-func">(</span><span class="hl-string">'textString'</span><span class="hl-gremlin-func">)</span>.dataType<span class="hl-gremlin-func">(</span>String.class<span class="hl-gremlin-func">)</span>.make<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.buildIndex<span class="hl-gremlin-func">(</span><span class="hl-string">'string'</span>,<span class="hl-gremlin-func"> </span>Vertex.class<span class="hl-gremlin-func">)</span>.addKey<span class="hl-gremlin-func">(</span>string,<span class="hl-gremlin-func"> </span>Mapping.STRING.asParameter<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span>Parameter.of<span class="hl-gremlin-func">(</span>ParameterType.STRING_ANALYZER.getName<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span><span class="hl-string">'standard'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">)</span>.buildMixedIndex<span class="hl-gremlin-func">(</span><span class="hl-string">"search"</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.buildIndex<span class="hl-gremlin-func">(</span><span class="hl-string">'text'</span>,<span class="hl-gremlin-func"> </span>Vertex.class<span class="hl-gremlin-func">)</span>.addKey<span class="hl-gremlin-func">(</span>text,<span class="hl-gremlin-func"> </span>Mapping.TEXT.asParameter<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span>Parameter.of<span class="hl-gremlin-func">(</span>ParameterType.TEXT_ANALYZER.getName<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span><span class="hl-string">'english'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">)</span>.buildMixedIndex<span class="hl-gremlin-func">(</span><span class="hl-string">"search"</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.buildIndex<span class="hl-gremlin-func">(</span><span class="hl-string">'textString'</span>,<span class="hl-gremlin-func"> </span>Vertex.class<span class="hl-gremlin-func">)</span>.addKey<span class="hl-gremlin-func">(</span>text,<span class="hl-gremlin-func"> </span>Mapping.TEXTSTRING.asParameter<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span>Parameter.of<span class="hl-gremlin-func">(</span>ParameterType.STRING_ANALYZER.getName<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span><span class="hl-string">'standard'</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span>Parameter.of<span class="hl-gremlin-func">(</span>ParameterType.TEXT_ANALYZER.getName<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span><span class="hl-string">'english'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">)</span>.buildMixedIndex<span class="hl-gremlin-func">(</span><span class="hl-string">"search"</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.commit<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span></pre><p>With these settings, JanusGraph will use the <span class="emphasis"><em>standard</em></span> analyzer for property key <span class="emphasis"><em>string</em></span> and the <span class="emphasis"><em>english</em></span> analyzer for property key <span class="emphasis"><em>text</em></span>.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_for_solr"></a>23.2.1.2.&nbsp;For Solr</h4></div></div></div><p>The class of the tokenizer must be set as parameter value.</p><pre class="programlisting">mgmt<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>graph.openManagement<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>string<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>mgmt.makePropertyKey<span class="hl-gremlin-func">(</span><span class="hl-string">'string'</span><span class="hl-gremlin-func">)</span>.dataType<span class="hl-gremlin-func">(</span>String.class<span class="hl-gremlin-func">)</span>.make<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>text<span class="hl-gremlin-func"> </span>=<span class="hl-gremlin-func"> </span>mgmt.makePropertyKey<span class="hl-gremlin-func">(</span><span class="hl-string">'text'</span><span class="hl-gremlin-func">)</span>.dataType<span class="hl-gremlin-func">(</span>String.class<span class="hl-gremlin-func">)</span>.make<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.buildIndex<span class="hl-gremlin-func">(</span><span class="hl-string">'string'</span>,<span class="hl-gremlin-func"> </span>Vertex.class<span class="hl-gremlin-func">)</span>.addKey<span class="hl-gremlin-func">(</span>string,<span class="hl-gremlin-func"> </span>Mapping.STRING.asParameter<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span>Parameter.of<span class="hl-gremlin-func">(</span>ParameterType.STRING_ANALYZER.getName<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span><span class="hl-string">'org.apache.lucene.analysis.standard.StandardTokenizer'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">)</span>.buildMixedIndex<span class="hl-gremlin-func">(</span><span class="hl-string">"search"</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.buildIndex<span class="hl-gremlin-func">(</span><span class="hl-string">'text'</span>,<span class="hl-gremlin-func"> </span>Vertex.class<span class="hl-gremlin-func">)</span>.addKey<span class="hl-gremlin-func">(</span>text,<span class="hl-gremlin-func"> </span>Mapping.TEXT.asParameter<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span>Parameter.of<span class="hl-gremlin-func">(</span>ParameterType.TEXT_ANALYZER.getName<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span>,<span class="hl-gremlin-func"> </span><span class="hl-string">'org.apache.lucene.analysis.core.WhitespaceTokenizer'</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">)</span>.buildMixedIndex<span class="hl-gremlin-func">(</span><span class="hl-string">"search"</span><span class="hl-gremlin-func">)</span><span class="hl-gremlin-func">
</span>mgmt.commit<span class="hl-gremlin-func">(</span><span class="hl-gremlin-func">)</span></pre><p>With these settings, JanusGraph will use the <span class="emphasis"><em>standard</em></span> tokenizer for property key <span class="emphasis"><em>string</em></span> and the <span class="emphasis"><em>whitespace</em></span> tokenizer for property key <span class="emphasis"><em>text</em></span>.</p></div></div></div></div></div><div class="clearer"></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="index-parameters.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index-backends.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="direct-index-query.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;22.&nbsp;Index Parameters and Full-Text Search&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;24.&nbsp;Direct Index Query</td></tr></table></div><div class="footer-wrapper"><footer id="footer"><div class="copyright">
              Copyright &copy; 2017 JanusGraph Authors. All rights reserved.<br>
              The Linux Foundation has registered trademarks and uses trademarks. For a list of<br>
              trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a> page.<br>
              Cassandra, Groovy, HBase, Hadoop, Lucene, Solr, and TinkerPop are trademarks of the Apache Software Foundation.<br>
              Berkeley DB and Berkeley DB Java Edition are trademarks of Oracle.<br>
              Documentation generated with <a href="http://www.methods.co.nz/asciidoc/">AsciiDoc</a>, <a href="http://asciidoctor.org/">AsciiDoctor</a>, <a href="http://docbook.sourceforge.net/">DocBook</a>, and <a href="http://saxon.sourceforge.net/">Saxon</a>.
        	  </div></footer></div></div></body></html>